---
title: "Homework 2"
author: "Yefrid Cordoba"
format: html
editor: visual
---

## Problem 1

A pharmaceutical manufacturer wants to investigate the bioactivity of a new drug. A completely randomized single-factor experiment was conducted with three dosage levels, and the following results were obtained.

![](images/clipboard-4043088528.png)

**Complete the ANOVA table:**

```{r}
nt <- 3 * 4
a <- 3
df_tr <- ( a - 1 )
df_tr
df_e <- nt - a
df_e
SStr <- 450.7
SST <- 783.9
SSe <- SST - SStr
SSe
MStr <- SStr / df_tr
MStr
MSe <- SSe / df_e
MSe
F_v <- MStr / MSe
F_v 
P_v <- pf(F_v, df_tr, df_e, lower.tail = F)
P_v
```

|   | df | SS | MS | F-Value | P-Value |
|------------|------------|------------|------------|------------|------------|
| **Bet\_ Dossage** | [`r round(df_tr, 2)`]{.underline} | 450.7 | [`r round(MStr, 2)`]{.underline} | [`r round(F_v, 2)`]{.underline} | [`r round(P_v, 3)`]{.underline} |
| **Error** | [`r round(df_e, 2)`]{.underline} | [`r round(SSe, 2)`]{.underline} | [`r round(MSe, 2)`]{.underline} |  |  |
| **Total** | [`r round(df_tr + df_e, 2)`]{.underline} | 783.9 |  |  |  |

### a.

Is there evidence to indicate that dosage level affects bioactivity?

**R/**\
Assuming an $\alpha = 0.05$, There is strong evidence to conclude that the at least one of the mean bioactivities is different from the others (P-value \< $\alpha$).

### b.

Compute a 95 percent interval estimate of the mean of dosage level is 30g.

**R/**

```{r}
dos20 <- c(24, 25, 37, 30)
dos30 <- c(37, 44, 31, 35)
dos40 <- c(42, 47, 52, 38)
x2 <- mean(dos30)
x2
s2 <- sd(dos30)
s2
n2 <- 4
n2
t2_star <- qt(.975, n2-1)
t2_star
SE2 <- s2 / sqrt(n2)
SE2
Upper <- x2 + t2_star * SE2
Upper
Lower<- x2 - t2_star * SE2
Lower
```

We are 95% confident that the true mean bioactivity of the new drug at a dosage of 30 mg is between (`r round(Lower, 2)`, `r round(Upper, 2)`).

### c.

Compute a 99 percent interval estimate of the mean difference between dosages levels 20g and 40g.

**R/**

```{r}
x1 <- mean(dos20)
x1
x3 <- mean(dos40)
x3
s1 <- sd(dos20)
s1
s2 <- sd(dos40)
s2
n1 = n3 = 4
PEs <- x3 - x1
PEs
df <- n1+n3-2
df
SE <- sqrt(MSe / n1 + MSe / n3)
SE
t_star <- qt(0.995, df, lower.tail = T)
t_star
Upper1 <- PEs + (SE * t_star)
Upper1
Lower1 <- PEs - (SE * t_star)
Lower1
```

We are 99% confident that the bioactivity of the new drug at a dosage of 40 mg is between `r round(Upper1, 2)` higher, and `r round(Lower1, 2)`) lower than the dosage of 20 mg.

### d.

Compute simultaneous 95% CIs for the difference in means for dosage levels 20g and 40g, based on Tukey’s, Bonferroni’s and Scheffe’s Methods:

**R/**

```{r}
#Tukey's HSD
Q <- qtukey(0.95, 3, 12-3)/sqrt(2)
Q
Up_Tu <- PEs + Q * SE
Up_Tu
Lo_Tu <- PEs - Q * SE
Lo_Tu
# Bonferroni
g = 3 * (3 - 1)/2
dfe = 12 - 3
t_bf = qt(1 - (0.05/(2*g)), dfe)
t_bf
Up_bf <- PEs + t_bf * SE
Up_bf
Lo_bf <- PEs - t_bf * SE
Lo_bf
# Scheffe
Sh <- sqrt((3 - 1) * qf(0.95, 3-1, dfe))
Sh
Up_sh <- PEs + Sh * SE
Up_sh
Lo_sh <- PEs - Sh * SE
Lo_sh
```

Tukey's HSD 95% confidence interval = (`r round(Lo_Tu, 2)`, `r round(Up_Tu, 2)`)\
Bonferroni's 95% confidence interval = (`r round(Lo_bf, 2)`, `r round(Up_bf, 2)`)\
Scheffe's 95% confidence interval = (`r round(Lo_sh, 2)`, `r round(Up_sh, 2)`)

### e.

Use Tukey’s HSD to compare pairs of treatment means.

**R/**\
When $| x_a - x_b | > Tukey's\  HSD$ we can conclude that there is a difference mean of $a$ is different of the mean of $b$

```{r}
# Tukey's HSD for all the comparisons
T_HSD <- Q * SE
T_HSD
abs(x1 - x2) > T_HSD #Comparison for dosage 20g to dosage 30g
abs(x1 - x3) > T_HSD #Comparison for dosage 20g to dosage 40g
abs(x2 - x3) > T_HSD #Comparison for dosage 30g to dosage 40g
```

For these comparisons, the only comparison in which the mean bioactivity of the new drug is significantly different, is when it is compared 20g and 40 g of dosage.

## Problem 2

The tensile strength of Portland cement is being studied. Four different mixing techniques can be used economically. A completely randomized experiment was conducted, and the following data were collected.

![](images/clipboard-3547813352.png){width="624"}

You are given the following information:

$\bar{Y}_{1.} = 2971.00$, $s(\bar{Y}_{1.}) = 56.65$ and, $MSE = 12825.7$\
$\bar{Y}_{2.} = 3156.25$, $s(\bar{Y}_{2.}) = 56.65$\
$\bar{Y}_{3.} = 2933.75$, $s(\bar{Y}_{3.}) = 56.65$\
$\bar{Y}_{4.} = 2666.25$, $s(\bar{Y}_{4.}) = 56.65$

### a.

Test the hypothesis that mixing techniques affect the strength of the cement. Test the hypothesis:

**R/**\
$$
H_o : \mu_1 = \mu_2 = \mu_3 = \mu_3
$$

$$
H_a  : At\:least\:one\: \mu_i \neq \mu_j \:; for \: i\neq j
$$

```{r}
dft <- 4-1
dfe <- 16-4
y1 <- 2971
y2 <- 3156.25
y3 <- 2933.75
y4 <- 2666.25
s1 = s2 = s3 = s4 = 56.65
n1 = n2 = n3 = n4 = 4
MSE <- 12825.7
y_bar = 4 * (y1 + y2 +y3 + y4) / 16
SSt = 4 * ((y1 - y_bar)^2 + (y2 - y_bar)^2 + (y3 - y_bar)^2 +(y4 - y_bar)^2 ) / dft
SSt
MSt <- SSt/dft
MSt
SSe <- MSE*dfe
SSe
F_v <- MSt / MSE
F_v
P_v <- pf(F_v, dft, dfe, lower.tail = F)
P_v
```

|   | df | SS | MS | F-Value | P-Value |
|------------|------------|------------|------------|------------|------------|
| **Mixing technique** | [3]{.underline} | [`r format(round(SSt, 2), scientific = F)`]{.underline} | [54415.6]{.underline} | [`r round(F_v, 2)`]{.underline} | [`r round(P_v, 3)`]{.underline} |
| **Error** | [12]{.underline} | [`r format(round(SSe, 2), scientific = F)`]{.underline} | 12825.7 |  |  |
| **Total** | [15]{.underline} | [`r format(round(SSt+SSe, 2), scientific = F)`]{.underline} |  |  |  |

As our P-value obtained is less than our $\alpha = 0.05$, we reject the null hypothesis, and we have enough evidence to conclude that at least one of the mean tensile strengths is different from the others when a different mixing technique is applied.

### b.

Find a 95 percent confidence interval on the mean tensile strength of the Portland cement produced by mixing technique 3.

**R/**

```{r}
t_star <- qt(.975, n3-1)
t_star
SE3 <- s3 / sqrt(n3)
SE3
Up3 <- y3 + t_star * SE3
Up3
Lo3 <- y3 - t_star * SE3
Lo3
```

We are 95% confident that the true mean tensile strength of the Portland cement produced by mixing technique 3 lies between (`r round(Lo3, 2)`, `r round(Up3, 2)`) $lb/in^2$.

### c.

Find a 95 percent confidence interval on the difference in means for techniques 1 and 3 & 3 and 4.

```{r}
PE31 <- y3 - y1
PE31
PE34 <- y3 - y4
PE34
df31 <- n1 + n3 - 2
df31
df34 <- n3 + n4 - 2
df34
SE <- sqrt( 2 * MSE / 4)
SE
t_star <- qt(0.975, df34, lower.tail = T)
t_star
Up31 <- PE31 + (SE * t_star)
Up31
Lo31 <- PE31 - (SE * t_star)
Lo31
Up34 <- PE34 + (SE * t_star)
Up34
Lo34 <- PE34 - (SE * t_star)
Lo34
```

We are 95% confident that the true difference in mean tensile strength for mixing technique 3 and 1 is between (`r round(Lo31, 2)`, `r round(Up31, 2)`) $lb/in^2$. That is the tensile strength for mixing technique 3 is between `r abs(round(Up31, 2))` $lb/in^2$ higher and `r abs(round(Lo31, 2))` $lb/in^2$ lower than mixing technique 1.\
We are 95% confident that the true difference in mean tensile strength for mixing technique 3 and 4 is between (`r round(Lo34, 2)`, `r round(Up34, 2)`) $lb/in^2$. That is the tensile strength for mixing technique 3 is between `r abs(round(Lo34, 2))` $lb/in^2$ and `r abs(round(Up34, 2))` $lb/in^2$ higher than mixing technique 1.

### d.

Compute simultaneous 95% CIs for the difference in means for techniques 1 and 3, based on Tukey’s, Bonferroni’s and Scheffe’s Methods:

**R/**

```{r}
#Tukey's HSD
Q <- qtukey(0.95, 4, 16-4)/sqrt(2)
Q
Up_Tu <- PE31 + Q * SE
Up_Tu
Lo_Tu <- PE31 - Q * SE
Lo_Tu
# Bonferroni
g = 4 * (4 - 1)/2
dfe = 16 - 4
t_bf = qt(1 - (0.05/(2*g)), dfe)
t_bf
Up_bf <- PE31 + t_bf * SE
Up_bf
Lo_bf <- PE31 - t_bf * SE
Lo_bf
# Scheffe
Sh <- sqrt((4 - 1) * qf(0.95, 4-1, dfe))
Sh
Up_sh <- PE31 + Sh * SE
Up_sh
Lo_sh <- PE31 - Sh * SE
Lo_sh
```

Tukey's HSD 95% confidence interval = (`r round(Lo_Tu, 2)`, `r round(Up_Tu, 2)`)\
Bonferroni's 95% confidence interval = (`r round(Lo_bf, 2)`, `r round(Up_bf, 2)`)\
Scheffe's 95% confidence interval = (`r round(Lo_sh, 2)`, `r round(Up_sh, 2)`)

### e.

Compute Bonferroni’s Minimum Significant Difference

```{r}
# Bonferroni
g <- 4 * (4 - 1)/2
dfe <- 16 - 4
t_bf <-  qt(1 - (0.05/(2*g)), dfe)
t_bf
Bf_MSD <- t_bf * sqrt( 2 * MSE / 4)
Bf_MSD
```

### f.

Compute Tukey’s Honest Significant Difference

```{r}

#Tukey's HSD
Tu_HSD <- (qtukey(0.95, 4, 16-4)/sqrt(2)) * sqrt( 2 * MSE / 4)
Tu_HSD
```

### g.

Compute Scheffe’s Minimum Significant Difference

**R/**

```{r}
Sh <- sqrt((4 - 1) * qf(0.95, 4-1, dfe))
Sh_MSD <- Sh * sqrt( 2 * MSE / 4)
Sh_MSD
```

## Problem 3

A study is conducted to compare 4 menus in terms of numbers of calories ordered by restaurant customers (in 100s of calories). The treatments (menus) are (consider them increasing in order of information provided):

1.  No Calories Reported

2.  Calories Reported

3.  Rank-Ordered Calories

4.  Color-Coded Calories

The sample sizes are all based on samples of r = 20 customers per menu. The sample means and estimated variance are:

$\bar{Y}_{1.} = 17.6$\
$\bar{Y}_{2.} = 16.8$\
$\bar{Y}_{3.} = 16.0$\
$\bar{Y}_{4.} = 14.4$\
$\bar{Y}_{..} = 16.2$\
$s^2 = MSE = 196.0$

Give 3 orthogonal contrasts, and their estimates and estimated standard errors.

**Contrast 1: Menu 1 vs Menus {2, 3, 4}**\

Contrast 1:

```{r}
Lhat_1 <- 3 * 17.7 - 16.8 - 16.0 - 14.4
Lhat_1
MSE <- 196
s_ci <- ( 3 ^ 2 /20) + (( -1) ^ 2 /20) + (( -1) ^ 2 /20) + (( -1) ^ 2 /20)
s_ci 
s_L1 <- sqrt( MSE * s_ci)
s_L1
```

$H_o: L_1 = \mu_1 = \frac{\mu_2 + \mu_3 + \mu_4}{3}$\
$L_1 = 3\mu_1 + (-1)\mu_2+ (-1)\mu_3+ (-1)\mu_4 = 0$\
$\hat{L_1} = 3\bar{y}_{1.}+ (-1)\bar{y}_{2.}+ (-1)\bar{y}_{3.}+ (-1)\bar{y}_{4.} =$ `r Lhat_1`\
$sd(\hat{L_1}) =$ `r round(s_L1, 2)`

**Contrast 2: Menu 2 vs Menus {3, 4}**\

```{r}
Lhat_2 <- 0 * 17.7 + 2 * 16.8 - 16.0 - 14.4
Lhat_2
MSE <- 196
s_ci <- ( 0 ^ 2 /20) + ( 2 ^ 2 /20) + (( -1) ^ 2 /20) + (( -1) ^ 2 /20)
s_ci 
s_L2 <- sqrt( MSE * s_ci)
s_L2
```

$H_o: L_2 = \mu_2 = \frac{\mu_3 + \mu_4}{2}$\
$L_2 = (0)\mu_1 + 2\mu_2+ (-1)\mu_3+ (-1)\mu_4 = 0$\
$\hat{L_2} = (0)\bar{y}_{1.}+ 2\bar{y}_{2.}+ (-1)\bar{y}_{3.}+ (-1)\bar{y}_{4.} =$ `r Lhat_2`\
$sd(\hat{L_2}) =$ `r round(s_L2, 2)`

**Contrast 3: Menu 3 vs Menu 4**\

```{r}
Lhat_3 <- 0 * 17.7 + 0 * 16.8 + 16.0 - 14.4
Lhat_3
MSE <- 196
s_ci <- ( 0 ^ 2 /20) + ( 0 ^ 2 /20) + (1 ^ 2 /20) + (( -1) ^ 2 /20)
s_ci 
s_L3 <- sqrt( MSE * s_ci)
s_L3
```

$H_o: L_3 = \mu_3 =  \mu_4$\
$L_3 = (0)\mu_1 + (0)\mu_2+ (1)\mu_3+ (-1)\mu_4 = 0$\
$\hat{L_3} = (0)\bar{y}_{1.}+ (0)\bar{y}_{2.}+ \bar{y}_{3.}+ (-1)\bar{y}_{4.} =$ `r Lhat_3`\
$sd(\hat{L_3}) =$ `r round(s_L3, 2)`

## Problem 4 R

An article in Environment International (Vol. 18, No. 4, 1992) describes an experiment in which the amount of radon released in showers was investigated. Radon enriched water was used in the experiment and six different Orifice diameters were tested in shower heads. The data from the experiment are shown in the following table.

![](images/clipboard-825273263.png)

### a.

Write a suitable model (Factor effects) for this experiment. Define all terms in the model. Include all assumptions of the model.

**R/**
```{r}
radon_release<-c(80,83,83,85,75,75,79,79,74,73,76,77,67,72,74,74,62,62,67,69,60,61,64,66)
diameter<-c(rep("0.37",4),rep("0.51",4),rep("0.71",4),rep("1.02",4),rep("1.40",4),rep("1.99",4))
radon_data<-data.frame(radon_release,diameter)
radon_data
str(radon_data)
model <- lm(radon_release ~ diameter, data = radon_data)
summary.aov(model)
tapply(radon_release, diameter, mean)
```

The assumptions for this model are:

- Independence of observations

- Equal variance between each level evaluated

- The residuals follow an approximately normal distribution

- Linearity



b.	Obtain point estimates and standard deviation of the radon released at each level.

c.	Does the size of the orifice affect the mean percentage of radon released? Use α = 0.05

d.	Construct a normal probability plot of the residuals. What conclusion would you draw about the validity of the normality assumption?

```{r}
qqnorm(residuals(model))
qqline(residuals(model))
```


e.	Plot the residuals versus the predicted radon release. Comment on the plot.

```{r}
plot(fitted.values(model), residuals(model), 
     xlab = "Fitted values", ylab = "Residuals")
abline(h = 0)
```


f.	Test by means of the Modified Leven’s (Brown-Forsythe) and Bartlett’s test whether the treatment error variances for the response variable are equal.

```{r}
library(car)

```


g.	Test the normality assumption using Shapiro-Wilk test.

```{r}
tapply(radon_release, diameter, shapiro.test)
```


h.	Use the Tukey’s and Bonferroni’s methods to make comparisons among the five treatments to determine specifically which treatments differ in radon release.

```{r}

```

